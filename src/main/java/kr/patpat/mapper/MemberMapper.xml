<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.patpat.mapper.MemberMapper">

	<resultMap type="kr.patpat.entity.Member" id="member">
		<result property="mbIdx" column="mb_idx"/>
		<result property="mbToken" column="mb_token"/>
		<result property="mbName" column="mb_name"/>
		<result property="mbNick" column="mb_nick"/>
		<result property="mbEmail" column="mb_email"/>
		<result property="mbPhone" column="mb_phone"/>
		<result property="mbProfile" column="mb_profile"/>
		<result property="mbAlarm" column="mb_alarm"/>
		<result property="mbJoinAt" column="mb_join_at"/>
		<result property="mbUpdateAt" column="mb_update_at"/>
		<result property="adminYn" column="admin_yn"/>
	</resultMap>
	
	<resultMap type="kr.patpat.entity.Pet" id="pet">
		<result property="petIdx" column="pet_idx"/>
		<result property="petName" column="pet_name"/>
		<result property="petAdoptionAt" column="pet_adoption_at"/>
		<result property="petPhoto" column="pet_photo"/>
		<result property="mbIdx" column="mb_idx"/>
		<result property="petGender" column="pet_gender"/>
	</resultMap>

	<insert id="join" parameterType="java.util.HashMap">
		insert into t_member (mb_token, mb_name, mb_nick, mb_email, mb_phone, mb_profile, mb_alarm, mb_join_at, mb_update_at, admin_yn) 
		values ('1', '1', #{nickname}, #{email}, '01012345678', '1', null, NOW(), NOW(), 'N');
	</insert>
   
	<select id="selectMember" parameterType="java.util.HashMap" resultMap="member">
		select * from t_member where mb_email=#{email}
	</select>
	
	<select id="selectUpdateMember" parameterType="String" resultMap="member">
		select * from t_member where mb_idx=#{mb_idx}
	</select>
	
	<select id="selectPet" parameterType="String" resultMap="pet">
		select pet_idx, pet_name, pet_adoption_at, pet_photo, mb_idx, pet_gender from t_pet where mb_idx=#{mbIdx}
	</select>
   
	<insert id="joinPet" parameterType="kr.patpat.entity.Member">
		insert into t_pet(pet_name, pet_adoption_at, pet_photo, mb_idx, pet_gender) 
		values('pet', null, null, #{mbIdx}, null)
	</insert>
	
	<update id="setAlarm" parameterType="java.util.HashMap">
		update t_member set mb_alarm=#{mb_alarm} where mb_idx=#{mb_idx}
	</update>
   
	<update id="setPet" parameterType="java.util.HashMap">
		update t_pet set pet_name=#{pet_name}, pet_adoption_at=#{pet_adoption_at}, pet_photo=#{pet_photo}, pet_gender=#{pet_gender} where mb_idx=#{mb_idx}
	</update>
	
</mapper>